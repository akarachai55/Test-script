-- Greatness Hub | Untitled RPG Game (World 1 & 2 Support) - COMPLETE VERSION
local Greatness = loadstring(game:HttpGet("https://gist.githubusercontent.com/Sandro2222/1e40185affd3a82a37b0fcbdaf7f27e8/raw/d80400589fb2220421e6e3bca00c7fca961bf7ca/GreatnessUI"))()

-- Create the window
local Window = Greatness:CreateWindow({
    Name = "Greatness Hub | Untitled RPG",
    Keybind = Enum.KeyCode.RightControl
})

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local UserInputService = game:GetService("UserInputService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local TweenService = game:GetService("TweenService")

local LocalPlayer = Players.LocalPlayer

-- Variables
local DetectedMobs = {}
local MobESPObjects = {}
local FarmConnection = nil
local AntiDieConnection = nil
local NoDamageConnection = nil
local SkillSpamConnection = nil
local LastDeathPosition = nil
local CurrentWorld = "World 1"
local PerformanceMode = true

-- Anti-Cheat Variables
local MacroSolverEnabled = true
local IsSolvingMacro = false
local BlockServerMessages = true
local AntiBanEnabled = false
local RandomizeActions = false
local ActionDelay = 0.1
local LastActionTime = 0
local AntiBanConnection = nil
local OriginalServerMessageFireServer = nil
local OriginalServerMessageOnClientEvent = nil
local MacroLoopConnection = nil
local LastMacroTime = 0

-- Movement Variables
local FlyEnabled = false
local NoclipEnabled = false
local FlySpeed = 50
local WalkSpeed = 16
local JumpPower = 50
local FlyConnection = nil
local NoclipConnection = nil
local ClickToTPEnabled = false
local ClickToTPConnection = nil
local FarmDistance = 4 -- Default farm distance

-- Feature Toggles
local NoDamageEnabled = false
local MobESPEnabled = false
local AntiDieEnabled = false
local AutoSkillE = false
local AutoSkillR = false
local AutoSkillT = false
local AutoSkill1 = false
local AutoSkill2 = false
local AutoSkill3 = false
local FarmPosition = "Back"
local ShowDistance = true
local ShowCoordinates = false

-- Monster Toggles (COMPLETE - ALL MOBS)
local MonsterToggles = {
    -- World 1 Mobs
    ["ê³ ë¸”ë¦°"] = false,
    ["ìŠ¬ë¼ì„"] = false,
    ["ê°‘ì˜· ê³ ë¸”ë¦°"] = false,
    ["ë™êµ´ ê³¨ë ˜"] = false,
    ["ìš©ì•” ê³¨ë ˜"] = false,
    ["ë§ˆê·¸ë§ˆ ë¸”ë˜ìŠ¤í„°"] = false,
    ["ìƒŒë“œ ìŠ¬ë¼ì„"] = false,
    ["ë¯¸ë¼"] = false,
    ["í”¼ë¼ë¯¸ë“œ ìˆ˜í˜¸ì"] = false,
    ["ë¬´ì‚¬"] = false,
    ["ì„ í˜ˆì˜ ì‚¬ë¬´ë¼ì´"] = false,
    ["íƒ€ì´íƒ„ ì•„ë¨¸ë¡œë“œ"] = false,
    ["ë‚˜ë½í™” ë°•ì¥"] = false,
    ["ë‚˜ë½í™” ìˆ˜í˜¸ì"] = false,
    ["ê²¨ìš¸ì„±ì˜ ìˆ˜í˜¸ì‹ "] = false,
    ["íŒŒê´´ì˜ ê´‘ì„ , ì¸íë„¤ì´ì…˜"] = false,
    ["ì˜ˆí‹°"] = false,
    ["ëˆˆì‚¬ëŒ"] = false,
    ["ìš©ì•”ì˜ í™”ì‹ "] = false,
    
    -- World 2 Mobs
    ["ê°ˆìƒ‰ì˜· ì£¼ë¯¼"] = false,
    ["ê¸°ì‚¬ ì£¼ë¯¼"] = false,
    ["ë‹¤í¬ ê¸°ì‚¬ë‹¨ì¥"] = false,
    ["ë” í• ë£¨ì‹œë„¤ì´ì…˜"] = false,
    ["ë§ˆë‚˜ ê´‘ë¬¼"] = false,
    ["ë§ˆë‚˜ ê´‘ì„"] = false,
    ["ì„œë¦¬ ëŠ‘ëŒ€"] = false,
    ["ìˆœìˆ˜í•œ ë§ˆë‚˜ ê´‘ì„"] = false,
    ["ì•„ë¥´ì¹´ë‚˜"] = false,
    ["ì–¸ë°ë“œ ì˜í˜¼ì²´"] = false,
    ["ì–¼ì–´ë¶™ì€ í•ë¹›"] = false,
    ["ìš©ë ¥ì„"] = false,
    ["íŒŒë¼ë‹¤ì´ìŠ¤ ë¬´ì‚¬"] = false,
    ["íŒŒë¼ë‹¤ì´ìŠ¤ ìˆ˜ì¥"] = false,
    ["íŒŒë€ì˜· ì£¼ë¯¼"] = false,
    ["í˜ì–´ë¦¬"] = false,
    ["í¬ìë§"] = false,
    ["í¬ëŒí‘¸ìŠ¤"] = false,
}

-- Mob HP Table
local MobHP = {
    -- World 1
    ["ê³ ë¸”ë¦°"] = 50,
    ["ìŠ¬ë¼ì„"] = 100,
    ["ê°‘ì˜· ê³ ë¸”ë¦°"] = 500,
    ["ë™êµ´ ê³¨ë ˜"] = 250,
    ["ìš©ì•” ê³¨ë ˜"] = 4575,
    ["ë§ˆê·¸ë§ˆ ë¸”ë˜ìŠ¤í„°"] = 2515,
    ["ìƒŒë“œ ìŠ¬ë¼ì„"] = 600,
    ["ë¯¸ë¼"] = 1070,
    ["í”¼ë¼ë¯¸ë“œ ìˆ˜í˜¸ì"] = 2010,
    ["ë¬´ì‚¬"] = 5350,
    ["ì„ í˜ˆì˜ ì‚¬ë¬´ë¼ì´"] = 62500,
    ["íƒ€ì´íƒ„ ì•„ë¨¸ë¡œë“œ"] = 100000,
    ["ë‚˜ë½í™” ë°•ì¥"] = 10500,
    ["ë‚˜ë½í™” ìˆ˜í˜¸ì"] = 500000,
    ["ê²¨ìš¸ì„±ì˜ ìˆ˜í˜¸ì‹ "] = 300000,
    ["íŒŒê´´ì˜ ê´‘ì„ , ì¸íë„¤ì´ì…˜"] = 250000,
    ["ì˜ˆí‹°"] = 150000,
    ["ëˆˆì‚¬ëŒ"] = 75000,
    ["ìš©ì•”ì˜ í™”ì‹ "] = 1000000,
    
    -- World 2
    ["ê°ˆìƒ‰ì˜· ì£¼ë¯¼"] = 250000,
    ["ê¸°ì‚¬ ì£¼ë¯¼"] = 875000,
    ["ë‹¤í¬ ê¸°ì‚¬ë‹¨ì¥"] = 8000000,
    ["ë” í• ë£¨ì‹œë„¤ì´ì…˜"] = 25000000,
    ["ë§ˆë‚˜ ê´‘ë¬¼"] = 350000,
    ["ë§ˆë‚˜ ê´‘ì„"] = 350000,
    ["ì„œë¦¬ ëŠ‘ëŒ€"] = 14000000,
    ["ìˆœìˆ˜í•œ ë§ˆë‚˜ ê´‘ì„"] = 10000000,
    ["ì•„ë¥´ì¹´ë‚˜"] = 165000000,
    ["ì–¸ë°ë“œ ì˜í˜¼ì²´"] = 1500000,
    ["ì–¼ì–´ë¶™ì€ í•ë¹›"] = 255000000,
    ["ìš©ë ¥ì„"] = 350000000,
    ["íŒŒë¼ë‹¤ì´ìŠ¤ ë¬´ì‚¬"] = 6000000,
    ["íŒŒë¼ë‹¤ì´ìŠ¤ ìˆ˜ì¥"] = 105000000,
    ["íŒŒë€ì˜· ì£¼ë¯¼"] = 550000,
    ["í˜ì–´ë¦¬"] = 1000000,
    ["í¬ìë§"] = 400000,
    ["í¬ëŒí‘¸ìŠ¤"] = 50000000,
}

-- Create tabs
local FarmTab = Window:CreateTab("Auto Farm")
local MovementTab = Window:CreateTab("Movement")
local VisualTab = Window:CreateTab("Visual")
local DefenceTab = Window:CreateTab("Defence")
local AntiCheatTab = Window:CreateTab("Anti-Cheat")
local PerformanceTab = Window:CreateTab("Performance")

-- ======== MOVEMENT FUNCTIONS ========
local function ApplyWalkSpeed()
    local character = LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = WalkSpeed
        end
    end
end

local function ApplyJumpPower()
    local character = LocalPlayer.Character
    if character then
        local humanoid = character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.JumpPower = JumpPower
        end
    end
end

local function EnableFly()
    if FlyConnection then 
        FlyConnection:Disconnect() 
        FlyConnection = nil
    end
    
    local character = LocalPlayer.Character
    if not character then return end
    
    local rootPart = character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return end
    
    local bodyGyro = Instance.new("BodyGyro")
    local bodyVelocity = Instance.new("BodyVelocity")
    
    bodyGyro.Parent = rootPart
    bodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    bodyGyro.P = 9e9
    
    bodyVelocity.Parent = rootPart
    bodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVelocity.Velocity = Vector3.new(0, 0, 0)
    
    FlyConnection = RunService.Heartbeat:Connect(function()
        if not FlyEnabled or not character or not rootPart then
            if bodyGyro then bodyGyro:Destroy() end
            if bodyVelocity then bodyVelocity:Destroy() end
            if FlyConnection then
                FlyConnection:Disconnect()
                FlyConnection = nil
            end
            return
        end
        
        local camera = Workspace.CurrentCamera
        bodyGyro.CFrame = camera.CFrame
        
        local velocity = Vector3.new()
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            velocity = velocity + (camera.CFrame.LookVector * FlySpeed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            velocity = velocity - (camera.CFrame.LookVector * FlySpeed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            velocity = velocity - (camera.CFrame.RightVector * FlySpeed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            velocity = velocity + (camera.CFrame.RightVector * FlySpeed)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            velocity = velocity + Vector3.new(0, FlySpeed, 0)
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then
            velocity = velocity - Vector3.new(0, FlySpeed, 0)
        end
        
        bodyVelocity.Velocity = velocity
    end)
end

local function EnableNoclip()
    if NoclipConnection then 
        NoclipConnection:Disconnect() 
        NoclipConnection = nil
    end
    
    NoclipConnection = RunService.Stepped:Connect(function()
        if not NoclipEnabled then 
            if NoclipConnection then
                NoclipConnection:Disconnect()
                NoclipConnection = nil
            end
            return 
        end
        
        local character = LocalPlayer.Character
        if character then
            for _, part in pairs(character:GetDescendants()) do
                if part:IsA("BasePart") then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function SetupClickToTP()
    if ClickToTPConnection then 
        ClickToTPConnection:Disconnect() 
        ClickToTPConnection = nil
    end
    
    ClickToTPConnection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if not ClickToTPEnabled or gameProcessed then return end
        
        if input.UserInputType == Enum.UserInputType.MouseButton1 and UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
            local mouse = LocalPlayer:GetMouse()
            if mouse.Target then
                local character = LocalPlayer.Character
                local rootPart = character and character:FindFirstChild("HumanoidRootPart")
                if rootPart then
                    rootPart.CFrame = CFrame.new(mouse.Hit.Position + Vector3.new(0, 3, 0))
                end
            end
        end
    end)
end

-- ======== ORIGINAL AUTO MACRO FUNCTIONS ========
local IsSolvingMacro = false
local LastMacroTime = 0
local MacroSolverEnabled = true
local MacroLoopConnection = nil
local RunService = game:GetService("RunService")
local LocalPlayer = game.Players.LocalPlayer

local function countKeys(t)
    local count = 0
    for _ in pairs(t) do count = count + 1 end
    return count
end

local function FindMacroGUI()
    local playerGui = LocalPlayer:WaitForChild("PlayerGui")
    
    for _, screenGui in pairs(playerGui:GetChildren()) do
        if screenGui:IsA("ScreenGui") and screenGui.Enabled and screenGui.Name == "MacroGui" then  -- à¸•à¸£à¸‡à¸Šà¸·à¹ˆà¸­à¸ˆà¸²à¸ log
            print("[Macro Debug] à¸à¸š MacroGui: " .. screenGui.Name)
            
            local codeLabel = nil
            local triggerElement = nil  -- placeholder à¸ªà¸µà¹€à¸—à¸²à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸„à¸¥à¸´à¸à¹€à¸›à¸´à¸” keypad
            
            for _, obj in pairs(screenGui:GetDescendants()) do
                if obj:IsA("TextLabel") then
                    local txt = obj.Text
                    if txt:find("ë‹¤ìŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”") or txt:find("ìˆ«ì") then
                        codeLabel = obj
                        print("[Macro Debug] à¸à¸š code label: " .. txt .. " | Path: " .. obj:GetFullName())
                    end
                    
                    -- à¸«à¸² placeholder à¸ªà¸µà¹€à¸—à¸² (à¸¡à¸±à¸à¹€à¸›à¹‡à¸™ TextLabel à¸«à¸£à¸·à¸­ Frame à¸—à¸µà¹ˆà¸¡à¸µ Text à¸§à¹ˆà¸²à¸‡/à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢)
                    if (obj:IsA("TextLabel") or obj:IsA("Frame")) and obj.Visible and 
                       (txt:lower():find("ì…ë ¥") or txt == "" or obj.BackgroundColor3 and obj.BackgroundTransparency < 0.5) then
                        if obj.Parent and obj.Parent:IsA("Frame") then
                            triggerElement = obj.Parent  -- à¸¡à¸±à¸à¸„à¸¥à¸´à¸ parent Frame
                        else
                            triggerElement = obj
                        end
                        print("[Macro Debug] à¸œà¸¹à¹‰à¸ªà¸¡à¸±à¸„à¸£ trigger (placeholder): " .. (triggerElement:GetFullName() or "nil") .. " | Text: " .. (txt or "à¹„à¸¡à¹ˆà¸¡à¸µ"))
                    end
                end
            end
            
            if codeLabel then
                -- à¸„à¸·à¸™à¸„à¹ˆà¸²à¹à¸¡à¹‰ trigger à¸­à¸²à¸ˆà¹„à¸¡à¹ˆà¹€à¸ˆà¸­ (à¸ˆà¸°à¸¥à¸­à¸‡à¸«à¸²à¹ƒà¸«à¸¡à¹ˆà¸«à¸¥à¸±à¸‡ simulate)
                return screenGui, triggerElement, codeLabel
            end
        end
    end
    
    print("[Macro Debug] à¹„à¸¡à¹ˆà¸à¸š MacroGui à¸«à¸£à¸·à¸­ code label")
    return nil, nil, nil
end

local function ExtractCodeFromLabel(codeLabel)
    if not codeLabel then return nil end
    local txt = codeLabel.Text
    local code = txt:match("ë‹¤ìŒ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:%s*(%d+)") or txt:match("(%d%d%d%d+)")
    if code and #code >= 4 and #code <= 6 then
        print("[Macro Debug] Extract code: " .. code)
        return code
    end
    return nil
end

local function FindKeypadButtons(macroGui)
    local keypad = {}
    for _, obj in pairs(macroGui:GetDescendants()) do
        if obj:IsA("TextButton") and obj.Visible and obj.Text:match("^%d$") then
            local digit = obj.Text
            keypad[digit] = obj
            print("[Macro Debug] Keypad digit: " .. digit .. " | " .. obj:GetFullName())
        end
    end
    local cnt = countKeys(keypad)
    print("[Macro Debug] à¸à¸š keypad: " .. cnt .. "/10")
    return cnt == 10 and keypad or nil
end

local function TypeCodeSafely(macroGui, triggerElement, code)
    if not code then return end
    
    -- Step 1: Simulate à¸„à¸¥à¸´à¸ trigger à¹€à¸à¸·à¹ˆà¸­à¹€à¸›à¸´à¸” keypad
    if triggerElement then
        pcall(function()
            triggerElement:Fire("MouseButton1Click")
            print("[Macro Debug] à¸„à¸¥à¸´à¸ trigger: " .. triggerElement:GetFullName())
        end)
    else
        -- à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¹€à¸ˆà¸­ trigger à¸¥à¸­à¸‡à¸„à¸¥à¸´à¸ codeLabel à¸«à¸£à¸·à¸­ parent Frame
        if macroGui:FindFirstChild("Frame", true) then
            local fallback = macroGui:FindFirstChild("Frame", true)
            pcall(function() fallback:Fire("MouseButton1Click") end)
            print("[Macro Debug] Fallback à¸„à¸¥à¸´à¸ Frame à¹à¸£à¸à¹ƒà¸™ MacroGui")
        end
    end
    task.wait(0.45)  -- à¸£à¸­ keypad à¹‚à¸«à¸¥à¸” (à¹€à¸à¸´à¹ˆà¸¡à¸ˆà¸²à¸ 0.3 à¹€à¸›à¹‡à¸™ 0.45 à¹€à¸à¸£à¸²à¸°à¸šà¸²à¸‡à¹€à¸à¸¡à¸Šà¹‰à¸²)
    
    -- Step 2: à¸«à¸² keypad à¸«à¸¥à¸±à¸‡à¹€à¸›à¸´à¸”
    local keypad = FindKeypadButtons(macroGui)
    if not keypad then return end
    
    -- Step 3: à¸à¸”à¸•à¸±à¸§à¹€à¸¥à¸‚à¸•à¸²à¸¡ code
    for i = 1, #code do
        local digit = code:sub(i, i)
        local btn = keypad[digit]
        if btn then
            pcall(function() btn:Fire("MouseButton1Click") end)
            print("[Macro Debug] à¸à¸” digit: " .. digit)
            task.wait(0.14 + math.random() * 0.1)
        else
            warn("[Macro Debug] à¹„à¸¡à¹ˆà¸¡à¸µà¸›à¸¸à¹ˆà¸¡à¸ªà¸³à¸«à¸£à¸±à¸š digit " .. digit)
            return
        end
    end
    
    -- Step 4: à¸¥à¸­à¸‡à¸à¸” "ì…ë ¥ ì´ˆê¸°í™”" à¸–à¹‰à¸²à¸ˆà¸³à¹€à¸›à¹‡à¸™ (à¹à¸•à¹ˆà¸›à¸à¸•à¸´ auto submit)
    task.wait(0.6)
    for _, btn in pairs(macroGui:GetDescendants()) do
        if btn:IsA("TextButton") and (btn.Text:find("ì´ˆê¸°í™”") or btn.Text:find("X") or btn.Text:find("ë‹«ê¸°")) then
            pcall(function() btn:Fire("MouseButton1Click") end)
            print("[Macro Debug] à¸à¸” " .. btn.Text .. " à¹€à¸à¸·à¹ˆà¸­ close/reset")
            break
        end
    end
end

local function SolveMacro()
    if IsSolvingMacro or tick() - LastMacroTime < 1.5 then return end
    IsSolvingMacro = true
    LastMacroTime = tick()
    
    local macroGui, trigger, codeLabel = FindMacroGUI()
    if not macroGui or not codeLabel then
        IsSolvingMacro = false
        return
    end
    
    local code = ExtractCodeFromLabel(codeLabel)
    if code then
        TypeCodeSafely(macroGui, trigger, code)
    end
    
    IsSolvingMacro = false
end

local function StartMacroSolverLoop()
    if MacroLoopConnection then MacroLoopConnection:Disconnect() end
    local last = 0
    MacroLoopConnection = RunService.Heartbeat:Connect(function()
        if tick() - last >= 1 then
            last = tick()
            if MacroSolverEnabled and not IsSolvingMacro then
                SolveMacro()
            end
        end
    end)
    print("[Macro Debug] Auto-solver loop à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸³à¸‡à¸²à¸™ (MacroGui mode)")
end

local function StopMacroSolverLoop()
    if MacroLoopConnection then
        MacroLoopConnection:Disconnect()
        MacroLoopConnection = nil
    end
end

-- à¹€à¸£à¸´à¹ˆà¸¡ loop
if MacroSolverEnabled then
    StartMacroSolverLoop()
end

-- ======== NUCLEAR MACRO ELIMINATOR ========
local function NuclearMacroEliminator()
    pcall(function()
        local macroRemote = ReplicatedStorage.Remote:FindFirstChild("Macro")
        if macroRemote then
            macroRemote:Destroy()
        end
    end)
    
    pcall(function()
        local playerGui = LocalPlayer:WaitForChild("PlayerGui")
        for _, gui in pairs(playerGui:GetChildren()) do
            if gui:IsA("ScreenGui") and (gui.Name == "Macro" or gui.Name:find("Captcha")) then
                gui:Destroy()
            end
        end
    end)
    
    pcall(function()
        local playerGui = LocalPlayer:WaitForChild("PlayerGui")
        playerGui.ChildAdded:Connect(function(child)
            if child:IsA("ScreenGui") and (child.Name == "Macro" or child.Name:find("Captcha")) then
                task.wait(0.05)
                child:Destroy()
            end
        end)
    end)
end

-- ======== ANTI-CHEAT FUNCTIONS ========
local function SetupServerMessageBlock()
    local success, serverMessage = pcall(function()
        local remoteFolder = ReplicatedStorage:WaitForChild("Remote")
        if remoteFolder then
            return remoteFolder:WaitForChild("ServerMessage")
        end
    end)
    
    if success and serverMessage then
        if serverMessage:IsA("RemoteEvent") then
            OriginalServerMessageFireServer = serverMessage.FireServer
            serverMessage.FireServer = function(self, ...)
                if BlockServerMessages then
                    return nil
                end
                return OriginalServerMessageFireServer(self, ...)
            end
        end
        
        if serverMessage:IsA("RemoteEvent") then
            OriginalServerMessageOnClientEvent = serverMessage.OnClientEvent
            serverMessage.OnClientEvent = function(...)
                if BlockServerMessages then
                    return nil
                end
                return OriginalServerMessageOnClientEvent(...)
            end
        end
    end
end

local function RemoveServerMessageBlock()
    local success, serverMessage = pcall(function()
        local remoteFolder = ReplicatedStorage:WaitForChild("Remote")
        if remoteFolder then
            return remoteFolder:WaitForChild("ServerMessage")
        end
    end)
    
    if success and serverMessage then
        if OriginalServerMessageFireServer then
            serverMessage.FireServer = OriginalServerMessageFireServer
        end
        if OriginalServerMessageOnClientEvent then
            serverMessage.OnClientEvent = OriginalServerMessageOnClientEvent
        end
    end
end

-- ======== ANTI-BAN SYSTEM ========
local function EnableAntiBan()
    if AntiBanConnection then 
        AntiBanConnection:Disconnect() 
        AntiBanConnection = nil
    end
    
    AntiBanConnection = RunService.Heartbeat:Connect(function()
        if not AntiBanEnabled then return end
        
        RandomizeActions = true
        
        if math.random(1, 100) == 1 then
            local character = LocalPlayer.Character
            if character then
                local rootPart = character:FindFirstChild("HumanoidRootPart")
                if rootPart then
                    local randomCF = CFrame.new(rootPart.Position) * CFrame.Angles(0, math.rad(math.random(0, 360)), 0)
                    rootPart.CFrame = rootPart.CFrame:Lerp(randomCF, 0.1)
                end
            end
        end
    end)
end

local function DisableAntiBan()
    if AntiBanConnection then
        AntiBanConnection:Disconnect()
        AntiBanConnection = nil
    end
    RandomizeActions = false
end

-- ======== OPTIMIZED SKILL SPAM ========
local function StartAutoSkills()
    if SkillSpamConnection then 
        SkillSpamConnection:Disconnect() 
        SkillSpamConnection = nil
    end
    
    SkillSpamConnection = RunService.Heartbeat:Connect(function()
        local delay = RandomizeActions and (0.05 + math.random() * 0.1) or 0.05
        
        if AutoSkillE then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.E, false, game)
            task.wait(delay)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.E, false, game)
        end
        
        if AutoSkillR then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.R, false, game)
            task.wait(delay)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.R, false, game)
        end
        
        if AutoSkillT then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.T, false, game)
            task.wait(delay)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.T, false, game)
        end
        
        if AutoSkill1 then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.One, false, game)
            task.wait(delay)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.One, false, game)
        end
        
        if AutoSkill2 then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Two, false, game)
            task.wait(delay)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Two, false, game)
        end
        
        if AutoSkill3 then
            VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Three, false, game)
            task.wait(delay)
            VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Three, false, game)
        end
        
        if RandomizeActions then
            task.wait(0.05 + math.random() * 0.15)
        else
            task.wait(0.1)
        end
    end)
end

local function StopAutoSkills()
    if SkillSpamConnection then
        SkillSpamConnection:Disconnect()
        SkillSpamConnection = nil
    end
end

-- ======== FIXED NO DAMAGE SYSTEM ========
local function EnableNoDamage()
    if NoDamageConnection then return end
    
    NoDamageConnection = RunService.Heartbeat:Connect(function()
        if not NoDamageEnabled then return end
        
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            if humanoid then
                if humanoid.Health < humanoid.MaxHealth then
                    humanoid.Health = humanoid.MaxHealth
                end
                
                if humanoid.Health <= 0 then
                    humanoid.Health = humanoid.MaxHealth
                end
            end
        end
    end)
end

local function DisableNoDamage()
    if NoDamageConnection then
        NoDamageConnection:Disconnect()
        NoDamageConnection = nil
    end
end

-- ======== FIXED ANTI-DIE SYSTEM ========
local function EnableAntiDie()
    if AntiDieConnection then 
        AntiDieConnection:Disconnect() 
        AntiDieConnection = nil
    end
    
    AntiDieConnection = RunService.Heartbeat:Connect(function()
        if not AntiDieEnabled then return end
        
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChild("Humanoid")
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            
            if humanoid and rootPart then
                if humanoid.Health > 0 then
                    LastDeathPosition = rootPart.Position
                end
                
                if humanoid.Health <= 10 then
                    humanoid.Health = humanoid.MaxHealth
                end
            end
        end
    end)
    
    LocalPlayer.CharacterAdded:Connect(function(character)
        task.wait(1)
        
        if AntiDieEnabled and LastDeathPosition then
            local rootPart = character:WaitForChild("HumanoidRootPart", 2)
            if rootPart then
                rootPart.CFrame = CFrame.new(LastDeathPosition)
            end
        end
    end)
end

local function DisableAntiDie()
    if AntiDieConnection then
        AntiDieConnection:Disconnect()
        AntiDieConnection = nil
    end
end

-- ======== AUTO FARM FUNCTIONS ========
local function ScanForMobs()
    DetectedMobs = {}
    
    local mobsFolder = Workspace:FindFirstChild("Mobs")
    if mobsFolder then
        for _, mob in pairs(mobsFolder:GetChildren()) do
            if mob:IsA("Model") and mob:FindFirstChild("Humanoid") and mob:FindFirstChild("HumanoidRootPart") then
                if mob.Humanoid.Health > 0 then
                    DetectedMobs[mob] = mob.Name
                end
            end
        end
    end
    
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Model") and obj:FindFirstChild("Humanoid") and obj:FindFirstChild("HumanoidRootPart") then
            local mobName = obj.Name
            if MonsterToggles[mobName] and obj.Humanoid.Health > 0 then
                DetectedMobs[obj] = mobName
            end
        end
    end
    
    for _, obj in pairs(Workspace:GetChildren()) do
        if obj:IsA("Model") and obj.Name == "ìš©ì•”ì˜ í™”ì‹ " and obj:FindFirstChild("Humanoid") then
            if obj.Humanoid.Health > 0 then
                DetectedMobs[obj] = "ìš©ì•”ì˜ í™”ì‹ "
            end
        end
    end
    
    return DetectedMobs
end

local function GetClosestMob()
    local character = LocalPlayer.Character
    local rootPart = character and character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return nil, nil, nil end
    
    local closestMob = nil
    local closestDistance = math.huge
    local mobPosition = nil
    
    for mob, koreanName in pairs(DetectedMobs) do
        if mob and mob.Parent and mob:FindFirstChild("HumanoidRootPart") then
            local humanoid = mob:FindFirstChild("Humanoid")
            if humanoid and humanoid.Health > 0 then
                if MonsterToggles[koreanName] then
                    local distance = (mob.HumanoidRootPart.Position - rootPart.Position).Magnitude
                    if distance < closestDistance then
                        closestMob = mob
                        closestDistance = distance
                        mobPosition = mob.HumanoidRootPart.Position
                    end
                end
            end
        end
    end
    
    return closestMob, closestDistance, mobPosition
end

local function TeleportToMob(mob)
    local character = LocalPlayer.Character
    local rootPart = character and character:FindFirstChild("HumanoidRootPart")
    if not rootPart or not mob or not mob:FindFirstChild("HumanoidRootPart") then return end
    
    local mobPosition = mob.HumanoidRootPart.Position
    local mobLookVector = mob.HumanoidRootPart.CFrame.LookVector
    local mobRightVector = mob.HumanoidRootPart.CFrame.RightVector
    
    local teleportPosition
    
    if FarmPosition == "Back" then
        teleportPosition = mobPosition - (mobLookVector * FarmDistance)
        teleportPosition = Vector3.new(teleportPosition.X, mobPosition.Y, teleportPosition.Z)
    elseif FarmPosition == "Front" then
        teleportPosition = mobPosition + (mobLookVector * FarmDistance)
        teleportPosition = Vector3.new(teleportPosition.X, mobPosition.Y, teleportPosition.Z)
    elseif FarmPosition == "Above" then
        teleportPosition = mobPosition + Vector3.new(0, FarmDistance + 4, 0)
    elseif FarmPosition == "Left" then
        teleportPosition = mobPosition - (mobRightVector * FarmDistance)
        teleportPosition = Vector3.new(teleportPosition.X, mobPosition.Y, teleportPosition.Z)
    elseif FarmPosition == "Right" then
        teleportPosition = mobPosition + (mobRightVector * FarmDistance)
        teleportPosition = Vector3.new(teleportPosition.X, mobPosition.Y, teleportPosition.Z)
    end
    
    local rayOrigin = teleportPosition + Vector3.new(0, 10, 0)
    local rayDirection = Vector3.new(0, -20, 0)
    local raycastParams = RaycastParams.new()
    raycastParams.FilterType = Enum.RaycastFilterType.Blacklist
    raycastParams.FilterDescendantsInstances = {character}
    
    local raycastResult = Workspace:Raycast(rayOrigin, rayDirection, raycastParams)
    
    if raycastResult then
        teleportPosition = Vector3.new(teleportPosition.X, raycastResult.Position.Y + 3, teleportPosition.Z)
    else
        teleportPosition = Vector3.new(teleportPosition.X, mobPosition.Y, teleportPosition.Z)
    end
    
    rootPart.CFrame = CFrame.new(teleportPosition, mobPosition)
end

local function AttackMob(mob)
    if not mob or not mob:FindFirstChild("HumanoidRootPart") then return end
    
    local damage = 999999
    
    pcall(function()
        ReplicatedStorage.Remote.HitBox:FireServer({
            Hit = mob.HumanoidRootPart,
            Damage = damage,
            Character = LocalPlayer.Character
        })
    end)
    
    pcall(function()
        ReplicatedStorage.Remote.Skill:FireServer("Attack", mob.HumanoidRootPart, damage)
    end)
    
    pcall(function()
        ReplicatedStorage.Remote.Emit:FireServer("Hit", mob.HumanoidRootPart, damage)
    end)
    
    pcall(function()
        ReplicatedStorage.Remote.HitBox:FireServer(mob.HumanoidRootPart, damage)
    end)
    
    local character = LocalPlayer.Character
    if character then
        for _, tool in pairs(character:GetChildren()) do
            if tool:IsA("Tool") then
                tool:Activate()
            end
        end
    end
end

local function StartAutoFarm()
    if FarmConnection then 
        FarmConnection:Disconnect() 
        FarmConnection = nil
    end
    
    local lastScanTime = 0
    local scanInterval = PerformanceMode and 2 or 1
    
    FarmConnection = RunService.Heartbeat:Connect(function()
        if tick() - LastActionTime < ActionDelay then return end
        LastActionTime = tick()
        
        if tick() - lastScanTime > scanInterval then
            ScanForMobs()
            lastScanTime = tick()
        end
        
        local closestMob, distance, mobPosition = GetClosestMob()
        if closestMob then
            TeleportToMob(closestMob)
            AttackMob(closestMob)
            
            if ShowDistance and distance then
                if ShowCoordinates and mobPosition then
                    print(string.format("ğŸ“ Target: %s | Distance: %.1f | Position: X:%.0f Y:%.0f Z:%.0f", 
                        closestMob.Name, distance, mobPosition.X, mobPosition.Y, mobPosition.Z))
                else
                    print(string.format("ğŸ“ Target: %s | Distance: %.1f", closestMob.Name, distance))
                end
            end
        end
    end)
end

local function StopAutoFarm()
    if FarmConnection then
        FarmConnection:Disconnect()
        FarmConnection = nil
    end
end

local function CheckIfAnyMonsterEnabled()
    for monster, enabled in pairs(MonsterToggles) do
        if enabled then
            StartAutoFarm()
            return true
        end
    end
    StopAutoFarm()
    return false
end

-- ======== OPTIMIZED ESP SYSTEM ========
local function UpdateESP()
    for mob, esp in pairs(MobESPObjects) do
        if esp then
            for _, drawing in pairs(esp) do
                pcall(function() drawing:Remove() end)
            end
        end
    end
    MobESPObjects = {}
    
    local updateCount = 0
    local maxUpdates = PerformanceMode and 15 or 30
    
    for mob, koreanName in pairs(DetectedMobs) do
        if updateCount >= maxUpdates then break end
        
        if mob and mob.Parent and mob:FindFirstChild("HumanoidRootPart") then
            local humanoid = mob:FindFirstChild("Humanoid")
            if humanoid and humanoid.Health > 0 then
                local esp = {
                    Box = Drawing.new("Square"),
                    Name = Drawing.new("Text"),
                    Health = Drawing.new("Text"),
                    Distance = Drawing.new("Text")
                }
                
                esp.Box.Visible = false
                esp.Box.Color = Color3.fromRGB(255, 0, 0)
                esp.Box.Thickness = 1
                esp.Box.Filled = false
                
                esp.Name.Visible = false
                esp.Name.Color = Color3.fromRGB(255, 255, 255)
                esp.Name.Size = PerformanceMode and 12 or 14
                esp.Name.Text = koreanName
                esp.Name.Center = true
                
                esp.Health.Visible = false
                esp.Health.Color = Color3.fromRGB(0, 255, 0)
                esp.Health.Size = PerformanceMode and 10 or 12
                esp.Health.Center = true
                
                esp.Distance.Visible = false
                esp.Distance.Color = Color3.fromRGB(255, 255, 0)
                esp.Distance.Size = PerformanceMode and 10 or 12
                esp.Distance.Center = true
                
                MobESPObjects[mob] = esp
                updateCount = updateCount + 1
            end
        end
    end
end

local function UpdateESPVisual(mob)
    local esp = MobESPObjects[mob]
    if not esp or not mob.Parent or not mob:FindFirstChild("HumanoidRootPart") then
        if esp then
            for _, drawing in pairs(esp) do
                pcall(function() drawing:Remove() end)
            end
            MobESPObjects[mob] = nil
        end
        return
    end
    
    local humanoid = mob:FindFirstChild("Humanoid")
    if not humanoid or humanoid.Health <= 0 then
        if esp then
            for _, drawing in pairs(esp) do
                pcall(function() drawing:Remove() end)
            end
            MobESPObjects[mob] = nil
        end
        return
    end
    
    local rootPos, onScreen = Workspace.CurrentCamera:WorldToViewportPoint(mob.HumanoidRootPart.Position)
    if not onScreen then
        esp.Box.Visible = false
        esp.Name.Visible = false
        esp.Health.Visible = false
        esp.Distance.Visible = false
        return
    end
    
    local isVisible = MobESPEnabled
    esp.Box.Visible = isVisible
    esp.Name.Visible = isVisible
    esp.Health.Visible = isVisible
    esp.Distance.Visible = isVisible and ShowDistance
    
    local headPos = Workspace.CurrentCamera:WorldToViewportPoint(mob.HumanoidRootPart.Position + Vector3.new(0, 2, 0))
    local width = math.abs(headPos.X - rootPos.X) * 1.5
    local height = (headPos.Y - rootPos.Y) * 1.5
    
    esp.Box.Size = Vector2.new(width, height)
    esp.Box.Position = Vector2.new(rootPos.X - width/2, rootPos.Y - height/2)
    
    esp.Name.Position = Vector2.new(rootPos.X, rootPos.Y - height/2 - 15)
    
    esp.Health.Text = math.floor(humanoid.Health) .. "/" .. math.floor(humanoid.MaxHealth)
    esp.Health.Position = Vector2.new(rootPos.X, rootPos.Y - height/2 - 30)
    
    local character = LocalPlayer.Character
    local rootPart = character and character:FindFirstChild("HumanoidRootPart")
    if rootPart and ShowDistance then
        local distance = (rootPart.Position - mob.HumanoidRootPart.Position).Magnitude
        
        if ShowCoordinates then
            esp.Distance.Text = string.format("Dist: %.1f | X:%.0f Y:%.0f Z:%.0f", 
                distance, mob.HumanoidRootPart.Position.X, mob.HumanoidRootPart.Position.Y, mob.HumanoidRootPart.Position.Z)
        else
            esp.Distance.Text = "Distance: " .. math.floor(distance)
        end
        esp.Distance.Position = Vector2.new(rootPos.X, rootPos.Y + height/2 + 5)
    end
end

local function ClearESP()
    for mob, esp in pairs(MobESPObjects) do
        if esp then
            for _, drawing in pairs(esp) do
                pcall(function() drawing:Remove() end)
            end
        end
    end
    MobESPObjects = {}
end

-- ======== PERFORMANCE OPTIMIZATION ========
local function OptimizePerformance()
    if PerformanceMode then
        ActionDelay = 0.15
    else
        ActionDelay = 0.1
    end
end

-- ======== GUI ELEMENTS ========

-- Farm Tab
Window:CreateSlider(FarmTab, {
    Name = "Farm Distance",
    Default = 4,
    Min = 1,
    Max = 20,
    Callback = function(value)
        FarmDistance = value
    end
})

Window:CreateLabel(FarmTab, {
    Text = "Select Farming Position:",
    TextSize = 14
})

Window:CreateButton(FarmTab, {
    Name = "Back Position (Safe)",
    Callback = function()
        FarmPosition = "Back"
    end
})

Window:CreateButton(FarmTab, {
    Name = "Front Position (Aggressive)",
    Callback = function()
        FarmPosition = "Front"
    end
})

Window:CreateButton(FarmTab, {
    Name = "Above Position (Air)",
    Callback = function()
        FarmPosition = "Above"
    end
})

Window:CreateButton(FarmTab, {
    Name = "Left Position (Close Side)",
    Callback = function()
        FarmPosition = "Left"
    end
})

Window:CreateButton(FarmTab, {
    Name = "Right Position (Close Side)",
    Callback = function()
        FarmPosition = "Right"
    end
})

Window:CreateLabel(FarmTab, {
    Text = "TP to Mobs:",
    TextSize = 14
})

Window:CreateButton(FarmTab, {
    Name = "Teleport to Closest Mob",
    Callback = function()
        local closestMob, distance, position = GetClosestMob()
        if closestMob then
            TeleportToMob(closestMob)
            print("Teleported to: " .. closestMob.Name)
        else
            print("No mobs found!")
        end
    end
})

Window:CreateButton(FarmTab, {
    Name = "Refresh Mobs List",
    Callback = function()
        ScanForMobs()
        local count = 0
        for _ in pairs(DetectedMobs) do count = count + 1 end
        print("Refreshed: " .. count .. " mobs found")
    end
})

Window:CreateButton(FarmTab, {
    Name = "Start Auto Farm",
    Callback = function()
        StartAutoFarm()
        print("Auto Farm: Started")
    end
})

Window:CreateButton(FarmTab, {
    Name = "Stop Auto Farm",
    Callback = function()
        StopAutoFarm()
        print("Auto Farm: Stopped")
    end
})

-- Create all 36 mob toggles
Window:CreateLabel(FarmTab, {
    Text = "--- World 1 Mobs (Early Game) ---",
    TextSize = 12
})

local world1Mobs = {
    "ê³ ë¸”ë¦°", "ìŠ¬ë¼ì„", "ê°‘ì˜· ê³ ë¸”ë¦°", "ë™êµ´ ê³¨ë ˜", "ìš©ì•” ê³¨ë ˜", "ë§ˆê·¸ë§ˆ ë¸”ë˜ìŠ¤í„°",
    "ìƒŒë“œ ìŠ¬ë¼ì„", "ë¯¸ë¼", "í”¼ë¼ë¯¸ë“œ ìˆ˜í˜¸ì", "ë¬´ì‚¬", "ì„ í˜ˆì˜ ì‚¬ë¬´ë¼ì´", "íƒ€ì´íƒ„ ì•„ë¨¸ë¡œë“œ",
    "ë‚˜ë½í™” ë°•ì¥", "ë‚˜ë½í™” ìˆ˜í˜¸ì", "ê²¨ìš¸ì„±ì˜ ìˆ˜í˜¸ì‹ ", "íŒŒê´´ì˜ ê´‘ì„ , ì¸íë„¤ì´ì…˜",
    "ì˜ˆí‹°", "ëˆˆì‚¬ëŒ", "ìš©ì•”ì˜ í™”ì‹ "
}

for _, mob in ipairs(world1Mobs) do
    Window:CreateToggle(FarmTab, {
        Name = mob .. " - HP: " .. tostring(MobHP[mob]),
        Default = false,
        Callback = function(value)
            MonsterToggles[mob] = value
            if value then
                CheckIfAnyMonsterEnabled()
            else
                CheckIfAnyMonsterEnabled()
            end
        end
    })
end

Window:CreateLabel(FarmTab, {
    Text = "--- World 2 Mobs (End Game) ---",
    TextSize = 12
})

local world2Mobs = {
    "ê°ˆìƒ‰ì˜· ì£¼ë¯¼", "ê¸°ì‚¬ ì£¼ë¯¼", "ë‹¤í¬ ê¸°ì‚¬ë‹¨ì¥", "ë” í• ë£¨ì‹œë„¤ì´ì…˜", "ë§ˆë‚˜ ê´‘ë¬¼", "ë§ˆë‚˜ ê´‘ì„",
    "ì„œë¦¬ ëŠ‘ëŒ€", "ìˆœìˆ˜í•œ ë§ˆë‚˜ ê´‘ì„", "ì•„ë¥´ì¹´ë‚˜", "ì–¸ë°ë“œ ì˜í˜¼ì²´", "ì–¼ì–´ë¶™ì€ í•ë¹›", "ìš©ë ¥ì„",
    "íŒŒë¼ë‹¤ì´ìŠ¤ ë¬´ì‚¬", "íŒŒë¼ë‹¤ì´ìŠ¤ ìˆ˜ì¥", "íŒŒë€ì˜· ì£¼ë¯¼", "í˜ì–´ë¦¬", "í¬ìë§", "í¬ëŒí‘¸ìŠ¤"
}

for _, mob in ipairs(world2Mobs) do
    Window:CreateToggle(FarmTab, {
        Name = mob .. " - HP: " .. tostring(MobHP[mob]),
        Default = false,
        Callback = function(value)
            MonsterToggles[mob] = value
            if value then
                CheckIfAnyMonsterEnabled()
            else
                CheckIfAnyMonsterEnabled()
            end
        end
    })
end

-- Auto Skill Toggles
Window:CreateLabel(FarmTab, {
    Text = "Auto Skill Spam:",
    TextSize = 14
})

local skillToggles = {
    {Name = "Auto Skill E", Var = "AutoSkillE", Key = Enum.KeyCode.E},
    {Name = "Auto Skill R", Var = "AutoSkillR", Key = Enum.KeyCode.R},
    {Name = "Auto Skill T", Var = "AutoSkillT", Key = Enum.KeyCode.T},
    {Name = "Auto Skill 1", Var = "AutoSkill1", Key = Enum.KeyCode.One},
    {Name = "Auto Skill 2", Var = "AutoSkill2", Key = Enum.KeyCode.Two},
    {Name = "Auto Skill 3", Var = "AutoSkill3", Key = Enum.KeyCode.Three}
}

for _, skill in ipairs(skillToggles) do
    Window:CreateToggle(FarmTab, {
        Name = skill.Name,
        Default = false,
        Callback = function(value)
            if skill.Var == "AutoSkillE" then AutoSkillE = value
            elseif skill.Var == "AutoSkillR" then AutoSkillR = value
            elseif skill.Var == "AutoSkillT" then AutoSkillT = value
            elseif skill.Var == "AutoSkill1" then AutoSkill1 = value
            elseif skill.Var == "AutoSkill2" then AutoSkill2 = value
            elseif skill.Var == "AutoSkill3" then AutoSkill3 = value end
            
            if value then
                if not SkillSpamConnection then
                    StartAutoSkills()
                end
            else
                if not AutoSkillE and not AutoSkillR and not AutoSkillT and 
                   not AutoSkill1 and not AutoSkill2 and not AutoSkill3 then
                    StopAutoSkills()
                end
            end
        end
    })
end

Window:CreateToggle(FarmTab, {
    Name = "Show Distance in Console",
    Default = true,
    Callback = function(value)
        ShowDistance = value
    end
})

Window:CreateToggle(FarmTab, {
    Name = "Show XYZ Coordinates",
    Default = false,
    Callback = function(value)
        ShowCoordinates = value
    end
})

-- Movement Tab
Window:CreateSlider(MovementTab, {
    Name = "WalkSpeed",
    Default = 16,
    Min = 16,
    Max = 200,
    Callback = function(value)
        WalkSpeed = value
        ApplyWalkSpeed()
    end
})

Window:CreateSlider(MovementTab, {
    Name = "JumpPower",
    Default = 50,
    Min = 50,
    Max = 200,
    Callback = function(value)
        JumpPower = value
        ApplyJumpPower()
    end
})

Window:CreateToggle(MovementTab, {
    Name = "Fly (Press X)",
    Default = false,
    Callback = function(value)
        FlyEnabled = value
        if value then
            EnableFly()
        else
            if FlyConnection then
                FlyConnection:Disconnect()
                FlyConnection = nil
            end
        end
    end
})

Window:CreateSlider(MovementTab, {
    Name = "Fly Speed",
    Default = 50,
    Min = 10,
    Max = 150,
    Callback = function(value)
        FlySpeed = value
    end
})

Window:CreateToggle(MovementTab, {
    Name = "NoClip (Press V)",
    Default = false,
    Callback = function(value)
        NoclipEnabled = value
        if value then
            EnableNoclip()
        else
            if NoclipConnection then
                NoclipConnection:Disconnect()
                NoclipConnection = nil
            end
        end
    end
})

Window:CreateToggle(MovementTab, {
    Name = "Click to TP (Hold LeftControl + Click)",
    Default = false,
    Callback = function(value)
        ClickToTPEnabled = value
        if value then
            SetupClickToTP()
        else
            if ClickToTPConnection then
                ClickToTPConnection:Disconnect()
                ClickToTPConnection = nil
            end
        end
    end
})

Window:CreateButton(MovementTab, {
    Name = "Apply Movement Settings",
    Callback = function()
        ApplyWalkSpeed()
        ApplyJumpPower()
        print("Movement settings applied!")
    end
})

-- Visual Tab
Window:CreateToggle(VisualTab, {
    Name = "Mob ESP",
    Default = false,
    Callback = function(value)
        MobESPEnabled = value
        if value then
            UpdateESP()
        else
            ClearESP()
        end
    end
})

Window:CreateToggle(VisualTab, {
    Name = "Show Distance on ESP",
    Default = true,
    Callback = function(value)
        ShowDistance = value
    end
})

-- Defence Tab
Window:CreateToggle(DefenceTab, {
    Name = "No Damage (God Mode)",
    Default = false,
    Callback = function(value)
        NoDamageEnabled = value
        if value then
            EnableNoDamage()
            print("No Damage Enabled - God Mode Active!")
        else
            DisableNoDamage()
            print("No Damage Disabled")
        end
    end
})

Window:CreateToggle(DefenceTab, {
    Name = "Anti-Die (Respawn at Death Location)",
    Default = false,
    Callback = function(value)
        AntiDieEnabled = value
        if value then
            EnableAntiDie()
            print("Anti-Die Enabled")
        else
            DisableAntiDie()
            print("Anti-Die Disabled")
        end
    end
})

-- Anti-Cheat Tab
Window:CreateToggle(AntiCheatTab, {
    Name = "Auto Macro Solver",
    Default = true,
    Callback = function(value)
        MacroSolverEnabled = value
        if value then
            StartMacroSolverLoop()
            print("Auto Macro Solver: Enabled")
        else
            StopMacroSolverLoop()
            print("Auto Macro Solver: Disabled")
        end
    end
})

Window:CreateToggle(AntiCheatTab, {
    Name = "Block Server Messages",
    Default = true,
    Callback = function(value)
        BlockServerMessages = value
        if value then
            SetupServerMessageBlock()
            print("ServerMessage Blocker: Enabled")
        else
            RemoveServerMessageBlock()
            print("ServerMessage Blocker: Disabled")
        end
    end
})

Window:CreateToggle(AntiCheatTab, {
    Name = "Enable Anti-Ban System",
    Default = false,
    Callback = function(value)
        AntiBanEnabled = value
        if value then
            EnableAntiBan()
            print("Anti-Ban: Enabled")
        else
            DisableAntiBan()
            print("Anti-Ban: Disabled")
        end
    end
})

Window:CreateToggle(AntiCheatTab, {
    Name = "Randomize Actions (Avoid Detection)",
    Default = false,
    Callback = function(value)
        RandomizeActions = value
        print(value and "Action Randomization: Enabled" or "Action Randomization: Disabled")
    end
})

Window:CreateButton(AntiCheatTab, {
    Name = "Test Macro Solver",
    Callback = function()
        print("Testing Macro Solver...")
        SolveMacro()
    end
})

Window:CreateButton(AntiCheatTab, {
    Name = "Delete All Macros",
    Callback = function()
        NuclearMacroEliminator()
        print("Nuclear Macro Eliminator Activated!")
    end
})

-- Performance Tab
Window:CreateToggle(PerformanceTab, {
    Name = "Performance Mode (Reduces Lag)",
    Default = true,
    Callback = function(value)
        PerformanceMode = value
        OptimizePerformance()
        print(value and "Performance Mode: Enabled" or "Performance Mode: Disabled")
    end
})

Window:CreateSlider(PerformanceTab, {
    Name = "Action Delay (Seconds)",
    Default = 0.1,
    Min = 0.05,
    Max = 0.5,
    Callback = function(value)
        ActionDelay = value
        print("Action Delay: " .. value .. "s")
    end
})

Window:CreateButton(PerformanceTab, {
    Name = "Clear ESP Cache",
    Callback = function()
        ClearESP()
        print("ESP Cache Cleared")
    end
})

Window:CreateButton(PerformanceTab, {
    Name = "Garbage Collect",
    Callback = function()
        collectgarbage("collect")
        print("Memory Cleaned")
    end
})

-- ======== KEYBINDS ========
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if gameProcessed then return end
    
    if input.KeyCode == Enum.KeyCode.X then
        FlyEnabled = not FlyEnabled
        if FlyEnabled then
            EnableFly()
            print("Fly: Enabled")
        else
            if FlyConnection then
                FlyConnection:Disconnect()
                FlyConnection = nil
            end
            print("Fly: Disabled")
        end
    end
    
    if input.KeyCode == Enum.KeyCode.V then
        NoclipEnabled = not NoclipEnabled
        if NoclipEnabled then
            EnableNoclip()
            print("NoClip: Enabled")
        else
            if NoclipConnection then
                NoclipConnection:Disconnect()
                NoclipConnection = nil
            end
            print("NoClip: Disabled")
        end
    end
end)

-- ======== INITIALIZATION ========
task.wait(2)

-- Apply initial movement settings
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    ApplyWalkSpeed()
    ApplyJumpPower()
    
    -- Re-enable features if they were active
    if FlyEnabled then EnableFly() end
    if NoclipEnabled then EnableNoclip() end
    if ClickToTPEnabled then SetupClickToTP() end
    if NoDamageEnabled then EnableNoDamage() end
    if AntiDieEnabled then EnableAntiDie() end
    if MacroSolverEnabled then StartMacroSolverLoop() end
    if AutoSkillE or AutoSkillR or AutoSkillT or AutoSkill1 or AutoSkill2 or AutoSkill3 then
        StartAutoSkills()
    end
    if MobESPEnabled then UpdateESP() end
end)

if LocalPlayer.Character then
    task.wait(1)
    ApplyWalkSpeed()
    ApplyJumpPower()
end

-- Initialize mobs
ScanForMobs()

-- Setup anti-cheat
SetupServerMessageBlock()

-- Start macro solver loop
task.wait(1)
StartMacroSolverLoop()

-- Apply performance settings
OptimizePerformance()

print("========================================")
print("Greatness Hub | Untitled RPG - COMPLETELY LOADED!")
print("âœ… ALL 36 Mob Toggles (World 1 & 2)")
print("âœ… Farm Distance Adjusting (1-20)")
print("âœ… Movement Tab with Fly, NoClip, WalkSpeed, JumpPower")
print("âœ… Click to TP (Hold LeftControl + Click)")
print("âœ… TP to Mobs Button")
print("âœ… Original Auto-Macro System")
print("âœ… Nuclear Macro Eliminator")
print("âœ… Anti-Die System")
print("âœ… No Damage System")
print("âœ… Skill Spam E, R, T, 1, 2, 3")
print("âœ… Distance Display with XYZ coordinates")
print("âœ… Anti-Ban System")
print("âœ… Performance Mode")
print("âœ… Optimized ESP")
print("========================================")
print("ğŸ“Œ Quick Start:")
print("1. Select mobs to farm from the list")
print("2. Adjust farm distance with slider")
print("3. Enable Auto-Macro solver")
print("4. Use Movement features: X for Fly, V for NoClip")
print("5. Hold LeftControl + Click to teleport")
print("========================================")

-- ESP Update loop
local espUpdateCount = 0
RunService.RenderStepped:Connect(function()
    espUpdateCount = espUpdateCount + 1
    
    if MobESPEnabled and (espUpdateCount % (PerformanceMode and 3 or 2) == 0) then
        for mob, esp in pairs(MobESPObjects) do
            UpdateESPVisual(mob)
        end
    end
end)

-- Farm update loop
local farmUpdateCount = 0
RunService.Heartbeat:Connect(function()
    farmUpdateCount = farmUpdateCount + 1
    
    if farmUpdateCount % 60 == 0 then -- Update mob list every 60 frames
        ScanForMobs()
        if MobESPEnabled then
            UpdateESP()
        end
    end
end)

-- Cleanup on exit
game:GetService("Players").LocalPlayer.CharacterRemoving:Connect(function()
    StopAutoFarm()
    StopAutoSkills()
    ClearESP()
end)

print("âœ… Script ready! Select mobs to farm and enable features!")



