-- ======== AUTO MACRO FUNCTIONS (UPDATED FOR NEW CAPTCHA SYSTEM) ========
-- Version: 2026 Update - Handles new keypad reveal system
-- Key Changes:
-- 1. Detect "Mecha Prevention" GUI
-- 2. Extract code from title or label (e.g., "8057" or "235")
-- 3. Find and click gray bar to reveal keypad
-- 4. Map randomized number buttons
-- 5. Click buttons in sequence
-- 6. Handle reset if needed
-- Assumptions:
-- - GUI Name: "Mecha Prevention" (ScreenGui)
-- - Code in TextLabel with digits (4-6 length)
-- - Gray bar: Frame/TextBox/Button with gray color (RGB ~128,128,128)
-- - Keypad: Frame with 10 TextButtons (0-9, randomized positions)
-- - No submit button visible; assumes auto-submit after input
-- Warnings:
-- - Timing delays added to avoid detection
-- - Use with caution; games detect rapid/automated clicks
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local VirtualInputManager = game:GetService("VirtualInputManager")
local LocalPlayer = Players.LocalPlayer
-- Variables
local MacroSolverEnabled = true
local IsSolvingMacro = false
local LastMacroTime = 0
local MacroLoopConnection = nil
local ActionDelay = 0.1  -- Adjustable delay for anti-detection
-- Helper: Find Mecha Prevention GUI
local function FindMacroGUI()
local playerGui = LocalPlayer:WaitForChild("PlayerGui")
for _, gui in pairs(playerGui:GetChildren()) do
if gui:IsA("ScreenGui") and gui.Name == "Mecha Prevention" and gui.Enabled then
return gui
end
end
return nil
end
-- Helper: Extract Code from GUI (digits 4-6)
local function ExtractCodeFromMacroGUI(macroGui)
if not macroGui then return nil end
for _, child in pairs(macroGui:GetDescendants()) do
if child:IsA("TextLabel") or child:IsA("TextBox") then
local text = child.Text
-- Clean text and match digits (e.g., "8057" or "235")
text = string.gsub(text, "[^%d]", "")  -- Remove non-digits
local code = text:match("%d%d%d%d%d?%d?")  -- 4-6 digits
if code and #code >= 4 and #code <= 6 then
return code
end
end
end
return nil
end
-- Helper: Find Gray Bar (assumes gray BackgroundColor3)
local function FindGrayBar(macroGui)
for _, child in pairs(macroGui:GetDescendants()) do
if (child:IsA("Frame") or child:IsA("TextButton") or child:IsA("ImageButton") or child:IsA("TextBox")) then
local bgColor = child.BackgroundColor3
if bgColor and math.abs(bgColor.R - 0.5) < 0.1 and math.abs(bgColor.G - 0.5) < 0.1 and math.abs(bgColor.B - 0.5) < 0.1 then
return child
end
end
end
return nil
end
-- Helper: Find Keypad Frame (assumes a Frame containing number buttons)
local function FindKeypad(macroGui)
for _, child in pairs(macroGui:GetDescendants()) do
if child:IsA("Frame") and #child:GetChildren() >= 10 then  -- At least 10 children (buttons)
local hasNumbers = false
for _, btn in pairs(child:GetChildren()) do
if btn:IsA("TextButton") and btn.Text:match("%d") then
hasNumbers = true
break
end
end
if hasNumbers then
return child
end
end
end
return nil
end
-- Helper: Map Number to Button
local function MapKeypadButtons(keypad)
local buttonMap = {}
for _, btn in pairs(keypad:GetChildren()) do
if btn:IsA("TextButton") and btn.Text:match("%d") then
local digit = btn.Text
buttonMap[digit] = btn
end
end
return buttonMap
end
-- Helper: Simulate Button Click (uses MouseButton1Click:Fire() for safety)
local function SimulateClick(button)
if button and (button:IsA("TextButton") or button:IsA("ImageButton")) then
if button.MouseButton1Click then
button.MouseButton1Click:Fire()
end
-- Fallback: VirtualInput (less reliable, more detectable)
-- VirtualInputManager:SendMouseButtonEvent(button.AbsolutePosition.X + button.AbsoluteSize.X/2, button.AbsolutePosition.Y + button.AbsoluteSize.Y/2, 0, true, game, 0)
-- task.wait(0.05)
-- VirtualInputManager:SendMouseButtonEvent(button.AbsolutePosition.X + button.AbsoluteSize.X/2, button.AbsolutePosition.Y + button.AbsoluteSize.Y/2, 0, false, game, 0)
end
end
-- Main Solve Function
local function SolveMacro()
if IsSolvingMacro or tick() - LastMacroTime < 2 then return end
IsSolvingMacro = true
LastMacroTime = tick()
local macroGui = FindMacroGUI()
if not macroGui then
IsSolvingMacro = false
return
end
-- Extract code
local code = ExtractCodeFromMacroGUI(macroGui)
if not code then
IsSolvingMacro = false
return
end
-- Find and click gray bar
local grayBar = FindGrayBar(macroGui)
if grayBar then
SimulateClick(grayBar)
task.wait(0.2 + math.random() * 0.1)  -- Random delay for anti-detection
end
-- Wait for keypad to appear (timeout 2s)
local startTime = tick()
local keypad
while tick() - startTime < 2 do
keypad = FindKeypad(macroGui)
if keypad then break end
task.wait(0.1)
end
if not keypad then
IsSolvingMacro = false
return
end
-- Map buttons
local buttonMap = MapKeypadButtons(keypad)
if next(buttonMap) == nil then
IsSolvingMacro = false
return
end
-- Click each digit in sequence
for i = 1, #code do
local digit = code:sub(i, i)
local button = buttonMap[digit]
if button then
SimulateClick(button)
task.wait(ActionDelay + math.random() * 0.05)  -- Random delay per click
end
end
-- Optional: Find and click reset if needed (if code wrong, but assume correct)
-- local resetButton = ... (add if necessary)
-- Close GUI if possible
task.wait(0.5)
for _, child in pairs(macroGui:GetDescendants()) do
if child:IsA("TextButton") and (child.Text:find("닫기") or child.Text == "X") then
SimulateClick(child)
break
end
end
IsSolvingMacro = false
end
-- Loop Starter
local function StartMacroSolverLoop()
if MacroLoopConnection then
MacroLoopConnection:Disconnect()
MacroLoopConnection = nil
end
local lastCheck = 0
MacroLoopConnection = RunService.Heartbeat:Connect(function()
if tick() - lastCheck >= 1 then
lastCheck = tick()
if MacroSolverEnabled and not IsSolvingMacro then
SolveMacro()
end
end
end)
end
local function StopMacroSolverLoop()
if MacroLoopConnection then
MacroLoopConnection:Disconnect()
MacroLoopConnection = nil
end
end
